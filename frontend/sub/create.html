<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KRaft</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      function submitForm() {
        const name = document.getElementById('cluster_name').value;
        const cidr = document.getElementById('cidr').value;

        console.log("meow");

        fetch('/api/create/clusters', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ name, cidr })
        })
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            document.getElementById('error-message').textContent = data.error;
          } else {
            document.getElementById('error-message').textContent = 'Success!';
            return true;
            // redirect to view all clusters
            // window.location.href = `/view`;
          }
        })
        .catch(error => {
          document.getElementById('error-message').textContent = 'An error occurred somewhere between here and the server.';
          console.error('Error:', error);
        });
        return false;

      }
    </script>

</head>
<body class="bg-black h-screen w-screen flex items-center justify-center m-0 p-0">
    <div class=" m-8 rounded-md shadow-lg max-w-2xl w-full mx-4 outline-white-500 h-[60vh]">
        <!-- bg-zinc-800 -->
        <div class="flex items-center mb-4">
            <a href="/"><h1 class="text-white font-mono text-3xl">KRaft</h1></a>
            <h3 class="text-white font-mono text-sm ml-2 self-end mb-1">by Alex</h3>
        </div>
        <div class="text-white font-mono flex flex-col mt-8">
            <a href="#" class="text-2xl underline block">> Create a cluster</a>
        </div>
        <!-- form, asking for cluster name, optionally domain to access on -->
        <form class="text-white text-xl font-mono flex flex-col mt-8" onsubmit="return submitForm();">
            <label for="cluster_name">Cluster name*:</label><br>
            <input class="text-gray-800" type="text" id="cluster_name" name="cluster_name" required><br>

            <label for="cidr">CIDR (comma-separated)</label><br>
            <input class="text-gray-800" type="text" id="cidr" name="cidr">

            <input type="submit" value="Submit">
        </form>

        <div class="text-2xl bg-red-300 font-mono mt-8 text-center" id="error-message">
            <!-- will be filled with error message -->
        </div>
    </div>
</body>
</html>
